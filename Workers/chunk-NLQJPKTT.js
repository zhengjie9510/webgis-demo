/**
 * @license
 * Cesium - https://github.com/CesiumGS/cesium
 * Version 1.111
 *
 * Copyright 2011-2022 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/CesiumGS/cesium/blob/main/LICENSE.md for full licensing details.
 */
import{a as le}from"./chunk-J4D4SQY2.js";import{a as Z}from"./chunk-Y33I6CKI.js";import{a as R}from"./chunk-JMG4RN2X.js";import{f as _,i as se}from"./chunk-DV7DPSRL.js";import{a as ae,b as v,d as $}from"./chunk-KCIWEUSR.js";import{a as e,b as ce,d as j}from"./chunk-F33YCXD2.js";import{a as Q}from"./chunk-DUBQPPQZ.js";var we={ROUNDED:0,MITERED:1,BEVELED:2},L=Object.freeze(we),g=[new e,new e],ge=new e,pe=new e,xe=new e,Se=new e,Te=new e,Ee=new e,Be=new e,Ce=new e,ze=new e,P=new e,W=new e,I={},ee=new ce;function Ae(e,t){let n=new Array(e.length);for(let r=0;r<e.length;r++){let a=e[r];ee=t.cartesianToCartographic(a,ee),n[r]=ee.height,e[r]=t.scaleToGeodeticSurface(a,a)}return n}function te(t,n,r,a){let o,l=t[0],i=t[1],c=e.angleBetween(l,i),s=Math.ceil(c/a),u=new Array(s);if(n===r){for(o=0;o<s;o++)u[o]=n;return u.push(r),u}let g=(r-n)/s;for(o=1;o<s;o++){let e=n+o*g;u[o]=e}return u[0]=n,u.push(r),u}var X=new e,Y=new e;function Oe(t,n,r,a){let o=new R(r,a),l=o.projectPointOntoPlane(e.add(r,t,X),X),i=o.projectPointOntoPlane(e.add(r,n,Y),Y),c=$.angleBetween(l,i);return i.x*l.y-i.y*l.x>=0?-c:c}var je=new e(-1,0,0),N=new v,De=new v,re=new j,Me=j.IDENTITY.clone(),ve=new e,Ne=new ae,ie=new e;function D(t,n,r,a,o,l,i,c){let s=ve,u=Ne;N=se.eastNorthUpToFixedFrame(t,o,N),s=v.multiplyByPointAsVector(N,je,s),s=e.normalize(s,s);let g=Oe(s,n,t,o);re=j.fromRotationZ(g,re),ie.z=l,N=v.multiplyTransformation(N,v.fromRotationTranslation(re,ie,De),N);let m=Me;m[0]=i;for(let f=0;f<c;f++)for(let t=0;t<r.length;t+=3)u=e.fromArray(r,t,u),u=j.multiplyByVector(m,u,u),u=v.multiplyByPoint(N,u,u),a.push(u.x,u.y,u.z);return a}var Ve=new e;function ne(t,n,r,a,o,l,i){for(let c=0;c<t.length;c+=3){let s=e.fromArray(t,c,Ve);a=D(s,n,r,a,o,l[c/3],i,1)}return a}function be(e,t){let n=e.length,r=new Array(6*n),a=0,o=t.x+t.width/2,l=t.y+t.height/2,i=e[0];r[a++]=i.x-o,r[a++]=0,r[a++]=i.y-l;for(let c=1;c<n;c++){i=e[c];let t=i.x-o,n=i.y-l;r[a++]=t,r[a++]=0,r[a++]=n,r[a++]=t,r[a++]=0,r[a++]=n}return i=e[0],r[a++]=i.x-o,r[a++]=0,r[a++]=i.y-l,r}function fe(e,t){let n=e.length,r=new Array(3*n),a=0,o=t.x+t.width/2,l=t.y+t.height/2;for(let i=0;i<n;i++)r[a++]=e[i].x-o,r[a++]=0,r[a++]=e[i].y-l;return r}var me=new _,ue=new e,he=new j;function ye(t,n,r,a,o,l,i,c,s,u){let g,m,f,y=e.angleBetween(e.subtract(n,t,P),e.subtract(r,t,W)),d=a===L.BEVELED?0:Math.ceil(y/Q.toRadians(5));if(g=o?j.fromQuaternion(_.fromAxisAngle(e.negate(t,P),y/(d+1),me),he):j.fromQuaternion(_.fromAxisAngle(t,y/(d+1),me),he),n=e.clone(n,ue),d>0){let r=u?2:1;for(let a=0;a<d;a++)n=j.multiplyByVector(g,n,n),m=e.subtract(n,t,P),m=e.normalize(m,m),o||(m=e.negate(m,m)),f=l.scaleToGeodeticSurface(n,W),i=D(f,m,c,i,l,s,1,r)}else m=e.subtract(n,t,P),m=e.normalize(m,m),o||(m=e.negate(m,m)),f=l.scaleToGeodeticSurface(n,W),i=D(f,m,c,i,l,s,1,1),r=e.clone(r,ue),m=e.subtract(r,t,P),m=e.normalize(m,m),o||(m=e.negate(m,m)),f=l.scaleToGeodeticSurface(r,W),i=D(f,m,c,i,l,s,1,1);return i}I.removeDuplicatesFromShape=function(e){let t=e.length,n=[];for(let r=t-1,a=0;a<t;r=a++){let t=e[r],o=e[a];$.equals(t,o)||n.push(o)}return n},I.angleIsGreaterThanPi=function(t,n,r,a){let o=new R(r,a),l=o.projectPointOntoPlane(e.add(r,t,X),X),i=o.projectPointOntoPlane(e.add(r,n,Y),Y);return i.x*l.y-i.y*l.x>=0};var Fe=new e,Ge=new e;I.computePositions=function(t,n,r,a,o){let l=a._ellipsoid,i=Ae(t,l),c=a._granularity,s=a._cornerType,u=o?be(n,r):fe(n,r),m=o?fe(n,r):void 0,f=r.height/2,y=r.width/2,d=t.length,h=[],p=o?[]:void 0,w=ge,j=pe,E=xe,B=Se,S=Te,v=Ee,N=Be,x=Ce,z=ze,A=t[0],b=t[1];B=l.geodeticSurfaceNormal(A,B),w=e.subtract(b,A,w),w=e.normalize(w,w),x=e.cross(B,w,x),x=e.normalize(x,x);let T,R,O=i[0],V=i[1];o&&(p=D(A,x,m,p,l,O+f,1,1)),z=e.clone(A,z),A=b,j=e.negate(w,j);for(let M=1;M<d-1;M++){let n=o?2:1;if(b=t[M+1],A.equals(b)){le("Positions are too close and are considered equivalent with rounding error.");continue}w=e.subtract(b,A,w),w=e.normalize(w,w),E=e.add(w,j,E),E=e.normalize(E,E),B=l.geodeticSurfaceNormal(A,B);let r=e.multiplyByScalar(B,e.dot(w,B),Fe);e.subtract(w,r,r),e.normalize(r,r);let a=e.multiplyByScalar(B,e.dot(j,B),Ge);if(e.subtract(j,a,a),e.normalize(a,a),Q.equalsEpsilon(Math.abs(e.dot(r,a)),1,Q.EPSILON7))h=D(z,x,u,h,l,O+f,1,1),z=A;else{E=e.cross(E,B,E),E=e.cross(B,E,E),E=e.normalize(E,E);let t=1/Math.max(.25,e.magnitude(e.cross(E,j,P))),r=I.angleIsGreaterThanPi(w,j,A,l);r?(S=e.add(A,e.multiplyByScalar(E,t*y,E),S),v=e.add(S,e.multiplyByScalar(x,y,v),v),g[0]=e.clone(z,g[0]),g[1]=e.clone(v,g[1]),T=te(g,O+f,V+f,c),R=Z.generateArc({positions:g,granularity:c,ellipsoid:l}),h=ne(R,x,u,h,l,T,1),x=e.cross(B,w,x),x=e.normalize(x,x),N=e.add(S,e.multiplyByScalar(x,y,N),N),s===L.ROUNDED||s===L.BEVELED?ye(S,v,N,s,r,l,h,u,V+f,o):(E=e.negate(E,E),h=D(A,E,u,h,l,V+f,t,n)),z=e.clone(N,z)):(S=e.add(A,e.multiplyByScalar(E,t*y,E),S),v=e.add(S,e.multiplyByScalar(x,-y,v),v),g[0]=e.clone(z,g[0]),g[1]=e.clone(v,g[1]),T=te(g,O+f,V+f,c),R=Z.generateArc({positions:g,granularity:c,ellipsoid:l}),h=ne(R,x,u,h,l,T,1),x=e.cross(B,w,x),x=e.normalize(x,x),N=e.add(S,e.multiplyByScalar(x,-y,N),N),s===L.ROUNDED||s===L.BEVELED?ye(S,v,N,s,r,l,h,u,V+f,o):h=D(A,E,u,h,l,V+f,t,n),z=e.clone(N,z)),j=e.negate(w,j)}O=V,V=i[M+1],A=b}g[0]=e.clone(z,g[0]),g[1]=e.clone(A,g[1]),T=te(g,O+f,V+f,c),R=Z.generateArc({positions:g,granularity:c,ellipsoid:l}),h=ne(R,x,u,h,l,T,1),o&&(p=D(A,x,m,p,l,V+f,1,1)),d=h.length;let G=o?d+p.length:d,Y=new Float64Array(G);return Y.set(h),o&&Y.set(p,d),Y};var $e=I;export{L as a,$e as b};